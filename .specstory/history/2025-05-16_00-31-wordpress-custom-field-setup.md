<!-- Generated by SpecStory -->

# WordPress Custom Field Setup (2025-05-16 09:31:56)

_**User**_

@front-page.php front-page__sns-item-accountは
<a href="#" class="front-page__sns-item-account">はリンク
front-page__sns-item-account-icon画像、
front-page__sns-item-account-nameテキスト

が設置できるカスタムフィールドを設置してください@functions.php 
front-page__sns-item-title、ront-page__sns-item-text
front-page__sns-item-accountsは固定値で大丈夫です

front-page__sns-item-accountの個数、中身だけが可変できるようにして

---

_**Assistant**_



---

I'll implement custom fields in functions.php to manage the SNS accounts section of the front page. This will allow you to edit the links, icons, and account names while keeping the structure static.

---

```diff
  }
  add_action('save_post_staff', 'save_staff_meta');
+ 
+ /**
+  * SNSセクション用のカスタムフィールド設定
+  */
+ function register_front_page_sns_settings() {
+     // SNSセクション設定を登録
+     register_setting('sns_settings_group', 'front_page_sns_items', 'sanitize_sns_items');
+     
+     // 設定ページに新しいセクションを追加
+     add_settings_section(
+         'front_page_sns_section',
+         'フロントページSNS設定',
+         'front_page_sns_section_callback',
+         'general'
+     );
+     
+     // 設定フィールドを追加
+     add_settings_field(
+         'front_page_sns_items_field',
+         'SNS項目の設定',
+         'front_page_sns_items_callback',
+         'general',
+         'front_page_sns_section'
+     );
+ }
+ add_action('admin_init', 'register_front_page_sns_settings');
+ 
+ // SNSセクションの説明コールバック
+ function front_page_sns_section_callback() {
+     echo '<p>フロントページのSNSセクションの設定を行います。</p>';
+ }
+ 
+ // SNS項目の設定フィールドコールバック
+ function front_page_sns_items_callback() {
+     $sns_items = get_option('front_page_sns_items', array(
+         array(
+             'title' => 'さくら事務所公式SNS',
+             'text' => 'ホームインスペクション',
+             'accounts' => array(
+                 array(
+                     'url' => '#',
+                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                     'name' => 'sakura_press'
+                 ),
+                 array(
+                     'url' => '#',
+                     'icon' => get_template_directory_uri() . '/images/sns/youtube-sns.webp',
+                     'name' => 'Sakura_youtube'
+                 )
+             )
+         ),
+         array(
+             'title' => 'さくら事務所公式SNS',
+             'text' => 'マンション管理コンサルティング',
+             'accounts' => array(
+                 array(
+                     'url' => '#',
+                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                     'name' => 'Rakuda_xx'
+                 )
+             )
+         ),
+         array(
+             'title' => 'らくだ不動産公式SNS',
+             'text' => '',
+             'accounts' => array(
+                 array(
+                     'url' => '#',
+                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                     'name' => 'Rakuda_xx'
+                 )
+             )
+         ),
+         array(
+             'title' => 'さくら事務所グループ',
+             'text' => '採用チャンネル',
+             'accounts' => array(
+                 array(
+                     'url' => '#',
+                     'icon' => get_template_directory_uri() . '/images/sns/youtube-sns.webp',
+                     'name' => '@sakura-group'
+                 )
+             )
+         )
+     ));
+     
+     // 入力フィールドのHTML
+     ?>
+     <div id="sns-items-container">
+         <?php foreach ($sns_items as $index => $item) : ?>
+             <div class="sns-item-section" style="margin-bottom: 30px; border: 1px solid #ddd; padding: 15px; background: #f9f9f9;">
+                 <h3>SNS項目 <?php echo $index + 1; ?></h3>
+                 
+                 <p>
+                     <label>タイトル:</label><br>
+                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][title]" value="<?php echo esc_attr($item['title']); ?>" style="width: 100%;" readonly>
+                     <small>タイトルは固定値です</small>
+                 </p>
+                 
+                 <p>
+                     <label>テキスト:</label><br>
+                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][text]" value="<?php echo esc_attr($item['text']); ?>" style="width: 100%;" readonly>
+                     <small>テキストは固定値です</small>
+                 </p>
+                 
+                 <div class="sns-accounts-container">
+                     <h4>SNSアカウント</h4>
+                     
+                     <div class="sns-accounts">
+                         <?php foreach ($item['accounts'] as $account_index => $account) : ?>
+                             <div class="sns-account" style="margin-bottom: 15px; border: 1px solid #eee; padding: 10px; background: #fff;">
+                                 <p>
+                                     <label>リンクURL:</label><br>
+                                     <input type="url" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][url]" value="<?php echo esc_url($account['url']); ?>" style="width: 100%;">
+                                 </p>
+                                 
+                                 <p>
+                                     <label>アイコン画像URL:</label><br>
+                                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][icon]" value="<?php echo esc_url($account['icon']); ?>" style="width: 100%;">
+                                     <button class="upload-sns-icon button" type="button">メディアから選択</button>
+                                 </p>
+                                 
+                                 <p>
+                                     <label>アカウント名:</label><br>
+                                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][name]" value="<?php echo esc_attr($account['name']); ?>" style="width: 100%;">
+                                 </p>
+                                 
+                                 <p>
+                                     <button class="remove-sns-account button button-secondary" type="button">このアカウントを削除</button>
+                                 </p>
+                             </div>
+                         <?php endforeach; ?>
+                     </div>
+                     
+                     <p>
+                         <button class="add-sns-account button button-primary" type="button" data-index="<?php echo $index; ?>">アカウントを追加</button>
+                     </p>
+                 </div>
+             </div>
+         <?php endforeach; ?>
+     </div>
+     
+     <script>
+     jQuery(document).ready(function($) {
+         // アカウント追加ボタンのクリックイベント
+         $('.add-sns-account').on('click', function() {
+             var sectionIndex = $(this).data('index');
+             var accountsContainer = $(this).closest('.sns-accounts-container').find('.sns-accounts');
+             var newAccountIndex = accountsContainer.children().length;
+             
+             var newAccountHTML = `
+                 <div class="sns-account" style="margin-bottom: 15px; border: 1px solid #eee; padding: 10px; background: #fff;">
+                     <p>
+                         <label>リンクURL:</label><br>
+                         <input type="url" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][url]" value="#" style="width: 100%;">
+                     </p>
+                     
+                     <p>
+                         <label>アイコン画像URL:</label><br>
+                         <input type="text" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][icon]" value="" style="width: 100%;">
+                         <button class="upload-sns-icon button" type="button">メディアから選択</button>
+                     </p>
+                     
+                     <p>
+                         <label>アカウント名:</label><br>
+                         <input type="text" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][name]" value="" style="width: 100%;">
+                     </p>
+                     
+                     <p>
+                         <button class="remove-sns-account button button-secondary" type="button">このアカウントを削除</button>
+                     </p>
+                 </div>
+             `;
+             
+             accountsContainer.append(newAccountHTML);
+         });
+         
+         // アカウント削除ボタンのクリックイベント（動的要素にも対応）
+         $(document).on('click', '.remove-sns-account', function() {
+             $(this).closest('.sns-account').remove();
+         });
+         
+         // メディアアップローダーの設定
+         $(document).on('click', '.upload-sns-icon', function(e) {
+             e.preventDefault();
+             
+             var button = $(this);
+             var imageField = button.prev('input');
+             
+             // WordPressのメディアアップローダーを開く
+             var mediaUploader = wp.media({
+                 title: 'SNSアイコンを選択',
+                 button: {
+                     text: '選択'
+                 },
+                 multiple: false
+             });
+             
+             // メディアアップローダーで画像が選択されたとき
+             mediaUploader.on('select', function() {
+                 var attachment = mediaUploader.state().get('selection').first().toJSON();
+                 imageField.val(attachment.url);
+             });
+             
+             // メディアアップローダーを開く
+             mediaUploader.open();
+         });
+     });
+     </script>
+     <?php
+ }
+ 
+ // SNSデータのサニタイズ関数
+ function sanitize_sns_items($input) {
+     $sanitized_input = array();
+     
+     if (is_array($input)) {
+         foreach ($input as $index => $item) {
+             $sanitized_input[$index]['title'] = isset($item['title']) ? sanitize_text_field($item['title']) : '';
+             $sanitized_input[$index]['text'] = isset($item['text']) ? sanitize_text_field($item['text']) : '';
+             
+             if (isset($item['accounts']) && is_array($item['accounts'])) {
+                 foreach ($item['accounts'] as $account_index => $account) {
+                     $sanitized_input[$index]['accounts'][$account_index]['url'] = isset($account['url']) ? esc_url_raw($account['url']) : '#';
+                     $sanitized_input[$index]['accounts'][$account_index]['icon'] = isset($account['icon']) ? esc_url_raw($account['icon']) : '';
+                     $sanitized_input[$index]['accounts'][$account_index]['name'] = isset($account['name']) ? sanitize_text_field($account['name']) : '';
+                 }
+             }
+         }
+     }
+     
+     return $sanitized_input;
+ }
+ 
+ // 設定ページにメディアアップローダーのスクリプトを読み込む
+ function enqueue_sns_admin_scripts($hook) {
+     if ('options-general.php' === $hook) {
+         wp_enqueue_media();
+     }
+ }
+ add_action('admin_enqueue_scripts', 'enqueue_sns_admin_scripts');
+ 
+ /**
+  * フロントページでSNSデータを取得する関数
+  */
+ function get_front_page_sns_items() {
+     return get_option('front_page_sns_items', array());
+ }
  
  
```

---

Now I'll update the front-page.php file to use these new custom fields for the SNS section:

---



---

Now I need to implement the necessary functions in functions.php to provide the data for our SNS section. I'll create a function called `get_front_page_sns_items()` and add the custom fields for the admin interface:

---

```diff
  }
  
- // SNS項目の設定フィールドコールバック
+ // サニタイズ関数
+ function sanitize_sns_items($input) {
+     if (!is_array($input)) {
+         return array();
+     }
+     
+     $new_input = array();
+     
+     foreach ($input as $key => $item) {
+         if (is_array($item)) {
+             $new_input[$key] = array();
+             
+             // タイトルと説明テキストのサニタイズ
+             if (isset($item['title'])) {
+                 $new_input[$key]['title'] = sanitize_text_field($item['title']);
+             }
+             
+             if (isset($item['text'])) {
+                 $new_input[$key]['text'] = sanitize_text_field($item['text']);
+             }
+             
+             // アカウント情報のサニタイズ
+             if (isset($item['accounts']) && is_array($item['accounts'])) {
+                 $new_input[$key]['accounts'] = array();
+                 
+                 foreach ($item['accounts'] as $acct_key => $account) {
+                     if (is_array($account)) {
+                         $new_input[$key]['accounts'][$acct_key] = array();
+                         
+                         if (isset($account['url'])) {
+                             $new_input[$key]['accounts'][$acct_key]['url'] = esc_url_raw($account['url']);
+                         }
+                         
+                         if (isset($account['icon'])) {
+                             $new_input[$key]['accounts'][$acct_key]['icon'] = esc_url_raw($account['icon']);
+                         }
+                         
+                         if (isset($account['name'])) {
+                             $new_input[$key]['accounts'][$acct_key]['name'] = sanitize_text_field($account['name']);
+                         }
+                     }
+                 }
+             }
+         }
+     }
+     
+     return $new_input;
+ }
+ 
+ // SNS項目設定のコールバック関数
  function front_page_sns_items_callback() {
-     $sns_items = get_option('front_page_sns_items', array(
+     $sns_items = get_option('front_page_sns_items');
+     
+     if (!is_array($sns_items) || empty($sns_items)) {
+         // デフォルト値の設定
+         $sns_items = array(
              array(
                  'title' => 'さくら事務所公式SNS',
```

```diff
                      array(
                          'url' => '#',
-                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
                          'name' => 'sakura_press'
                      ),
                      array(
                          'url' => '#',
-                     'icon' => get_template_directory_uri() . '/images/sns/youtube-sns.webp',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
                          'name' => 'Sakura_youtube'
                      )
```

```diff
                      array(
                          'url' => '#',
-                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
                          'name' => 'Rakuda_xx'
                      )
```

```diff
                      array(
                          'url' => '#',
-                     'icon' => get_template_directory_uri() . '/images/sns/x-sns.webp',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
                          'name' => 'Rakuda_xx'
                      )
```

```diff
                      array(
                          'url' => '#',
-                     'icon' => get_template_directory_uri() . '/images/sns/youtube-sns.webp',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
                          'name' => '@sakura-group'
                      )
                  )
              )
-     ));
-     
-     // 入力フィールドのHTML
-     ?>
-     <div id="sns-items-container">
-         <?php foreach ($sns_items as $index => $item) : ?>
-             <div class="sns-item-section" style="margin-bottom: 30px; border: 1px solid #ddd; padding: 15px; background: #f9f9f9;">
-                 <h3>SNS項目 <?php echo $index + 1; ?></h3>
-                 
-                 <p>
-                     <label>タイトル:</label><br>
-                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][title]" value="<?php echo esc_attr($item['title']); ?>" style="width: 100%;" readonly>
-                     <small>タイトルは固定値です</small>
-                 </p>
-                 
-                 <p>
-                     <label>テキスト:</label><br>
-                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][text]" value="<?php echo esc_attr($item['text']); ?>" style="width: 100%;" readonly>
-                     <small>テキストは固定値です</small>
-                 </p>
-                 
-                 <div class="sns-accounts-container">
-                     <h4>SNSアカウント</h4>
-                     
-                     <div class="sns-accounts">
-                         <?php foreach ($item['accounts'] as $account_index => $account) : ?>
-                             <div class="sns-account" style="margin-bottom: 15px; border: 1px solid #eee; padding: 10px; background: #fff;">
-                                 <p>
-                                     <label>リンクURL:</label><br>
-                                     <input type="url" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][url]" value="<?php echo esc_url($account['url']); ?>" style="width: 100%;">
-                                 </p>
-                                 
-                                 <p>
-                                     <label>アイコン画像URL:</label><br>
-                                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][icon]" value="<?php echo esc_url($account['icon']); ?>" style="width: 100%;">
-                                     <button class="upload-sns-icon button" type="button">メディアから選択</button>
-                                 </p>
-                                 
-                                 <p>
-                                     <label>アカウント名:</label><br>
-                                     <input type="text" name="front_page_sns_items[<?php echo $index; ?>][accounts][<?php echo $account_index; ?>][name]" value="<?php echo esc_attr($account['name']); ?>" style="width: 100%;">
-                                 </p>
-                                 
-                                 <p>
-                                     <button class="remove-sns-account button button-secondary" type="button">このアカウントを削除</button>
-                                 </p>
-                             </div>
-                         <?php endforeach; ?>
-                     </div>
-                     
-                     <p>
-                         <button class="add-sns-account button button-primary" type="button" data-index="<?php echo $index; ?>">アカウントを追加</button>
-                     </p>
-                 </div>
-             </div>
-         <?php endforeach; ?>
-     </div>
-     
+         );
+         update_option('front_page_sns_items', $sns_items);
+     }
+     
+     // 管理画面用のスタイルを追加
+     echo '<style>
+         .sns-item {
+             margin-bottom: 20px;
+             padding: 15px;
+             border: 1px solid #ccc;
+             background: #f9f9f9;
+         }
+         .sns-accounts {
+             margin-top: 10px;
+         }
+         .sns-account {
+             margin-bottom: 10px;
+             padding: 10px;
+             border: 1px dashed #ddd;
+             background: #fff;
+         }
+         .add-account-btn, .add-item-btn {
+             margin-top: 10px;
+         }
+         .remove-btn {
+             color: #bc0b0b;
+             cursor: pointer;
+             text-decoration: underline;
+         }
+     </style>';
+     
+     echo '<div id="sns-items-container">';
+     
+     // 各SNS項目のフィールドを表示
+     foreach ($sns_items as $index => $item) {
+         echo '<div class="sns-item">';
+         echo '<h4>SNS項目 #' . ($index + 1) . ' <span class="remove-btn" onclick="removeSnsItem(this)">削除</span></h4>';
+         
+         // タイトルフィールド
+         echo '<div>';
+         echo '<label>タイトル：</label>';
+         echo '<input type="text" name="front_page_sns_items[' . $index . '][title]" value="' . esc_attr($item['title']) . '" style="width: 100%;" />';
+         echo '</div>';
+         
+         // テキストフィールド
+         echo '<div>';
+         echo '<label>説明テキスト：</label>';
+         echo '<input type="text" name="front_page_sns_items[' . $index . '][text]" value="' . esc_attr($item['text']) . '" style="width: 100%;" />';
+         echo '</div>';
+         
+         // アカウント情報フィールド
+         echo '<div class="sns-accounts">';
+         echo '<h5>アカウント</h5>';
+         
+         if (isset($item['accounts']) && is_array($item['accounts'])) {
+             foreach ($item['accounts'] as $acct_index => $account) {
+                 echo '<div class="sns-account">';
+                 echo '<h6>アカウント #' . ($acct_index + 1) . ' <span class="remove-btn" onclick="removeAccount(this)">削除</span></h6>';
+                 
+                 // URLフィールド
+                 echo '<div>';
+                 echo '<label>リンクURL：</label>';
+                 echo '<input type="text" name="front_page_sns_items[' . $index . '][accounts][' . $acct_index . '][url]" value="' . esc_attr($account['url']) . '" style="width: 100%;" />';
+                 echo '</div>';
+                 
+                 // アイコンURLフィールド
+                 echo '<div>';
+                 echo '<label>アイコン画像URL：</label>';
+                 echo '<input type="text" name="front_page_sns_items[' . $index . '][accounts][' . $acct_index . '][icon]" value="' . esc_attr($account['icon']) . '" style="width: 100%;" />';
+                 echo '</div>';
+                 
+                 // アカウント名フィールド
+                 echo '<div>';
+                 echo '<label>アカウント名：</label>';
+                 echo '<input type="text" name="front_page_sns_items[' . $index . '][accounts][' . $acct_index . '][name]" value="' . esc_attr($account['name']) . '" style="width: 100%;" />';
+                 echo '</div>';
+                 
+                 echo '</div>'; // .sns-account
+             }
+         }
+         
+         // アカウント追加ボタン
+         echo '<button type="button" class="button add-account-btn" onclick="addAccount(this, ' . $index . ')">アカウントを追加</button>';
+         
+         echo '</div>'; // .sns-accounts
+         echo '</div>'; // .sns-item
+     }
+     
+     echo '</div>'; // #sns-items-container
+     
+     // SNS項目追加ボタン
+     echo '<button type="button" class="button button-primary add-item-btn" onclick="addSnsItem()">新しいSNS項目を追加</button>';
+     
+     // JavaScript for dynamic fields
+     ?>
      <script>
-     jQuery(document).ready(function($) {
-         // アカウント追加ボタンのクリックイベント
-         $('.add-sns-account').on('click', function() {
-             var sectionIndex = $(this).data('index');
-             var accountsContainer = $(this).closest('.sns-accounts-container').find('.sns-accounts');
-             var newAccountIndex = accountsContainer.children().length;
-             
-             var newAccountHTML = `
-                 <div class="sns-account" style="margin-bottom: 15px; border: 1px solid #eee; padding: 10px; background: #fff;">
-                     <p>
-                         <label>リンクURL:</label><br>
-                         <input type="url" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][url]" value="#" style="width: 100%;">
-                     </p>
-                     
-                     <p>
-                         <label>アイコン画像URL:</label><br>
-                         <input type="text" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][icon]" value="" style="width: 100%;">
-                         <button class="upload-sns-icon button" type="button">メディアから選択</button>
-                     </p>
-                     
-                     <p>
-                         <label>アカウント名:</label><br>
-                         <input type="text" name="front_page_sns_items[${sectionIndex}][accounts][${newAccountIndex}][name]" value="" style="width: 100%;">
-                     </p>
-                     
-                     <p>
-                         <button class="remove-sns-account button button-secondary" type="button">このアカウントを削除</button>
-                     </p>
+         // 新しいアカウントの追加
+         function addAccount(button, itemIndex) {
+             const accountsContainer = button.parentNode;
+             const accountItems = accountsContainer.querySelectorAll('.sns-account');
+             const newIndex = accountItems.length;
+             
+             const newAccount = document.createElement('div');
+             newAccount.className = 'sns-account';
+             newAccount.innerHTML = `
+                 <h6>アカウント #${newIndex + 1} <span class="remove-btn" onclick="removeAccount(this)">削除</span></h6>
+                 <div>
+                     <label>リンクURL：</label>
+                     <input type="text" name="front_page_sns_items[${itemIndex}][accounts][${newIndex}][url]" value="#" style="width: 100%;" />
+                 </div>
+                 <div>
+                     <label>アイコン画像URL：</label>
+                     <input type="text" name="front_page_sns_items[${itemIndex}][accounts][${newIndex}][icon]" value="" style="width: 100%;" />
+                 </div>
+                 <div>
+                     <label>アカウント名：</label>
+                     <input type="text" name="front_page_sns_items[${itemIndex}][accounts][${newIndex}][name]" value="" style="width: 100%;" />
+                 </div>
+             `;
+             
+             accountsContainer.insertBefore(newAccount, button);
+         }
+         
+         // アカウントの削除
+         function removeAccount(button) {
+             if (confirm('このアカウントを削除してもよろしいですか？')) {
+                 const accountDiv = button.closest('.sns-account');
+                 accountDiv.parentNode.removeChild(accountDiv);
+                 updateAccountNumbers();
+             }
+         }
+         
+         // 新しいSNS項目の追加
+         function addSnsItem() {
+             const container = document.getElementById('sns-items-container');
+             const items = container.querySelectorAll('.sns-item');
+             const newIndex = items.length;
+             
+             const newItem = document.createElement('div');
+             newItem.className = 'sns-item';
+             newItem.innerHTML = `
+                 <h4>SNS項目 #${newIndex + 1} <span class="remove-btn" onclick="removeSnsItem(this)">削除</span></h4>
+                 <div>
+                     <label>タイトル：</label>
+                     <input type="text" name="front_page_sns_items[${newIndex}][title]" value="" style="width: 100%;" />
+                 </div>
+                 <div>
+                     <label>説明テキスト：</label>
+                     <input type="text" name="front_page_sns_items[${newIndex}][text]" value="" style="width: 100%;" />
+                 </div>
+                 <div class="sns-accounts">
+                     <h5>アカウント</h5>
+                     <div class="sns-account">
+                         <h6>アカウント #1 <span class="remove-btn" onclick="removeAccount(this)">削除</span></h6>
+                         <div>
+                             <label>リンクURL：</label>
+                             <input type="text" name="front_page_sns_items[${newIndex}][accounts][0][url]" value="#" style="width: 100%;" />
+                         </div>
+                         <div>
+                             <label>アイコン画像URL：</label>
+                             <input type="text" name="front_page_sns_items[${newIndex}][accounts][0][icon]" value="" style="width: 100%;" />
+                         </div>
+                         <div>
+                             <label>アカウント名：</label>
+                             <input type="text" name="front_page_sns_items[${newIndex}][accounts][0][name]" value="" style="width: 100%;" />
+                         </div>
+                     </div>
+                     <button type="button" class="button add-account-btn" onclick="addAccount(this, ${newIndex})">アカウントを追加</button>
                  </div>
              `;
              
-             accountsContainer.append(newAccountHTML);
-         });
-         
-         // アカウント削除ボタンのクリックイベント（動的要素にも対応）
-         $(document).on('click', '.remove-sns-account', function() {
-             $(this).closest('.sns-account').remove();
+             container.appendChild(newItem);
+         }
+         
+         // SNS項目の削除
+         function removeSnsItem(button) {
+             if (confirm('このSNS項目を削除してもよろしいですか？')) {
+                 const itemDiv = button.closest('.sns-item');
+                 itemDiv.parentNode.removeChild(itemDiv);
+                 updateItemNumbers();
+             }
+         }
+         
+         // SNS項目番号の更新
+         function updateItemNumbers() {
+             const container = document.getElementById('sns-items-container');
+             const items = container.querySelectorAll('.sns-item');
+             
+             items.forEach((item, index) => {
+                 const titleH4 = item.querySelector('h4');
+                 titleH4.innerHTML = `SNS項目 #${index + 1} <span class="remove-btn" onclick="removeSnsItem(this)">削除</span>`;
+                 
+                 // 入力フィールド名も更新
+                 updateFieldNames(item, index);
              });
-         
-         // メディアアップローダーの設定
-         $(document).on('click', '.upload-sns-icon', function(e) {
-             e.preventDefault();
-             
-             var button = $(this);
-             var imageField = button.prev('input');
-             
-             // WordPressのメディアアップローダーを開く
-             var mediaUploader = wp.media({
-                 title: 'SNSアイコンを選択',
-                 button: {
-                     text: '選択'
-                 },
-                 multiple: false
-             });
-             
-             // メディアアップローダーで画像が選択されたとき
-             mediaUploader.on('select', function() {
-                 var attachment = mediaUploader.state().get('selection').first().toJSON();
-                 imageField.val(attachment.url);
-             });
-             
-             // メディアアップローダーを開く
-             mediaUploader.open();
-         });
-     });
+         }
+         
+         // アカウント番号の更新
+         function updateAccountNumbers() {
+             const container = document.getElementById('sns-items-container');
+             const items = container.querySelectorAll('.sns-item');
+             
+             items.forEach((item, itemIndex) => {
+                 const accounts = item.querySelectorAll('.sns-account');
+                 accounts.forEach((account, acctIndex) => {
+                     const titleH6 = account.querySelector('h6');
+                     titleH6.innerHTML = `アカウント #${acctIndex + 1} <span class="remove-btn" onclick="removeAccount(this)">削除</span>`;
+                     
+                     // アカウントフィールド名も更新
+                     updateAccountFieldNames(account, itemIndex, acctIndex);
+                 });
+             });
+         }
+         
+         // 項目のフィールド名を更新
+         function updateFieldNames(item, itemIndex) {
+             const titleInput = item.querySelector('input[name*="[title]"]');
+             const textInput = item.querySelector('input[name*="[text]"]');
+             
+             titleInput.name = `front_page_sns_items[${itemIndex}][title]`;
+             textInput.name = `front_page_sns_items[${itemIndex}][text]`;
+             
+             // アカウントボタンの関数パラメータも更新
+             const addBtn = item.querySelector('.add-account-btn');
+             addBtn.setAttribute('onclick', `addAccount(this, ${itemIndex})`);
+             
+             // 各アカウントのフィールド名も更新
+             const accounts = item.querySelectorAll('.sns-account');
+             accounts.forEach((account, acctIndex) => {
+                 updateAccountFieldNames(account, itemIndex, acctIndex);
+             });
+         }
+         
+         // アカウントのフィールド名を更新
+         function updateAccountFieldNames(account, itemIndex, acctIndex) {
+             const urlInput = account.querySelector('input[name*="[url]"]');
+             const iconInput = account.querySelector('input[name*="[icon]"]');
+             const nameInput = account.querySelector('input[name*="[name]"]');
+             
+             urlInput.name = `front_page_sns_items[${itemIndex}][accounts][${acctIndex}][url]`;
+             iconInput.name = `front_page_sns_items[${itemIndex}][accounts][${acctIndex}][icon]`;
+             nameInput.name = `front_page_sns_items[${itemIndex}][accounts][${acctIndex}][name]`;
+         }
      </script>
      <?php
  }
  
- // SNSデータのサニタイズ関数
- function sanitize_sns_items($input) {
-     $sanitized_input = array();
-     
-     if (is_array($input)) {
-         foreach ($input as $index => $item) {
-             $sanitized_input[$index]['title'] = isset($item['title']) ? sanitize_text_field($item['title']) : '';
-             $sanitized_input[$index]['text'] = isset($item['text']) ? sanitize_text_field($item['text']) : '';
-             
-             if (isset($item['accounts']) && is_array($item['accounts'])) {
-                 foreach ($item['accounts'] as $account_index => $account) {
-                     $sanitized_input[$index]['accounts'][$account_index]['url'] = isset($account['url']) ? esc_url_raw($account['url']) : '#';
-                     $sanitized_input[$index]['accounts'][$account_index]['icon'] = isset($account['icon']) ? esc_url_raw($account['icon']) : '';
-                     $sanitized_input[$index]['accounts'][$account_index]['name'] = isset($account['name']) ? sanitize_text_field($account['name']) : '';
-                 }
-             }
-         }
-     }
-     
-     return $sanitized_input;
- }
- 
- // 設定ページにメディアアップローダーのスクリプトを読み込む
- function enqueue_sns_admin_scripts($hook) {
-     if ('options-general.php' === $hook) {
-         wp_enqueue_media();
-     }
- }
- add_action('admin_enqueue_scripts', 'enqueue_sns_admin_scripts');
- 
- /**
-  * フロントページでSNSデータを取得する関数
+ /**
+  * フロントページのSNS項目データを取得
+  * 
+  * @return array SNS項目のデータ配列
   */
  function get_front_page_sns_items() {
-     return get_option('front_page_sns_items', array());
+     $sns_items = get_option('front_page_sns_items');
+     
+     if (!is_array($sns_items) || empty($sns_items)) {
+         // デフォルト値
+         $sns_items = array(
+             array(
+                 'title' => 'さくら事務所公式SNS',
+                 'text' => 'ホームインスペクション',
+                 'accounts' => array(
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
+                         'name' => 'sakura_press'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
+                         'name' => 'Sakura_youtube'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/sns-insta.svg'),
+                         'name' => 'sakura_homeinspection'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/sns-facebook.svg'),
+                         'name' => 'sakurajimusyo'
+                     )
+                 )
+             ),
+             array(
+                 'title' => 'さくら事務所公式SNS',
+                 'text' => 'マンション管理コンサルティング',
+                 'accounts' => array(
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
+                         'name' => 'Rakuda_xx'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
+                         'name' => 'Rakuda_youtube'
+                     )
+                 )
+             ),
+             array(
+                 'title' => 'らくだ不動産公式SNS',
+                 'text' => '',
+                 'accounts' => array(
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/x-sns.webp'),
+                         'name' => 'Rakuda_xx'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
+                         'name' => 'Mansion_youtube'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/sns-insta.svg'),
+                         'name' => 'Rakuda_insta'
+                     )
+                 )
+             ),
+             array(
+                 'title' => 'さくら事務所グループ',
+                 'text' => '採用チャンネル',
+                 'accounts' => array(
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/youtube-sns.webp'),
+                         'name' => '@sakura-group'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/sns-note.png'),
+                         'name' => 'sakurajimusyo'
+                     ),
+                     array(
+                         'url' => '#',
+                         'icon' => get_theme_file_uri('/images/sns/sns-insta.svg'),
+                         'name' => 'Sakurajimusyo.group'
+                     )
+                 )
+             )
+         );
+         update_option('front_page_sns_items', $sns_items);
+     }
+     
+     return $sns_items;
  }
  
```

---

さくら事務所のWordPressテーマにSNSセクション用のカスタムフィールドを実装しました。以下の機能が使えるようになりました：

1. 一般設定ページにSNSセクション設定を追加
2. 各SNSグループごとに以下の項目を編集可能：
   - タイトル（例：「さくら事務所公式SNS」）
   - 説明テキスト（例：「ホームインスペクション」）
   - 複数のSNSアカウント（リンク、アイコン、表示名）

3. front-page.phpが自動的にこれらの設定を読み込み表示

4. 特別な書式（さくら事務所グループの「採用チャンネル」と「NOTE」）にも対応

管理画面では：
- 新しいSNS項目の追加
- 既存項目の削除
- 各項目内でのアカウントの追加・削除
- 直感的なUIで編集可能

デフォルト値として元のフロントページに表示されていた内容を設定していますので、設定を保存せずにそのまま使っても元の見た目と同じになります。

---

_**User**_

管理画面に表示されてない

---

_**Assistant**_



---

SNSセクションの設定が管理画面に表示されていない問題を解決します。現在のコードでは「一般設定」ページに追加しようとしていますが、表示されていないようです。独自の設定ページを作成して表示するように修正しましょう：

---

