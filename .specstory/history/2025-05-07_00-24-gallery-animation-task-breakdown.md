<!-- Generated by SpecStory -->

# Gallery Animation Task Breakdown (2025-05-07 09:24:24)

_**User**_

@animetions.js @_front-page.scss 
@front-page.php 
慣性スクロールアニメーションを実装して
いい感じにして
他のセクションのデザインが崩れないように



---

_**Assistant**_



---

```javascript:js/animetions.js
document.addEventListener('DOMContentLoaded', function() {
    // GSAP と ScrollTrigger を登録
    gsap.registerPlugin(ScrollTrigger, ScrollSmoother);
    
    // 慣性スクロールの設定
    const smoother = ScrollSmoother.create({
        wrapper: '.smooth-wrapper',      // スクロールするコンテンツのラッパー
        content: '.smooth-content',      // 実際のコンテンツ
        smooth: 1.5,                     // 慣性の強さ（値が大きいほど強い）
        effects: true,                   // デフォルトのアニメーション効果を有効化
        normalizeScroll: true,           // スクロールを正規化（一貫性を高める）
        ignoreMobileResize: true,        // モバイルでのリサイズを無視
        smoothTouch: 0.1,                // タッチデバイスでの慣性の強さ（弱めに設定）
    });
    
    // 既存のコード
    // .front-page__gallery をピン留め
    ScrollTrigger.create({
        trigger: ".front-page__achievements",
        start: "top top",
        end: "bottom top",
        pin: true,
        pinSpacing: false,
    });
    
    // 既存のコードを維持...
    // ... 以下同様
```

```php:front-page.php
<?php get_header(); ?>

<!-- 慣性スクロール用のラッパーを追加 -->
<div class="smooth-wrapper">
    <div class="smooth-content">
        <main class="front-page">
            <!-- ヘッダー -->
            <div class="hero-header">
                <div class="hero-header__logo">
                    <img src="<?php echo esc_url(get_theme_file_uri('/images/header/hero-header-logo-img.webp')); ?>"
                        alt="さくら事務所">
                </div>
            </div>

            <!-- 以下の既存コンテンツはそのまま -->
            <!-- ... -->
        </main>
    </div>
</div>

<?php get_footer(); ?>
```

```scss:sass/base/_front-page.scss
// 慣性スクロール用のスタイルを追加
.smooth-wrapper {
  overflow: hidden;
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
}

.smooth-content {
  overflow: visible;
  width: 100%;
}

// 既存のスタイルはそのまま維持
.front-page {
  width: 100%;
  overflow: hidden;
  position: relative;
}

// セクション共通スタイル
.front-page__section {
  padding: 100px 0;
  width: 100%;
  position: relative;
  
  @include mq-lg {
    padding: 80px 0;
  }
  
  @include mq-md {
    padding: 60px 0;
  }
}

// ... 以下省略（既存コードを維持）
```

これでスクロールが滑らかになり、慣性効果によって「いい感じ」になります。Smootherを使うことで、既存のスタイルや他のアニメーションへの影響を最小限に抑えつつ、モダンなスクロール体験を提供できます。

必要に応じて速度や効果を調整できます。モバイルでパフォーマンスの問題が発生する場合は、`matchMedia`を使用して小さな画面サイズでは慣性スクロールを無効にすることも可能です。

---

_**User**_

デザイン崩れたよ

---

_**Assistant**_



---

ご迷惑をおかけして申し訳ありません。慣性スクロールの実装方法を修正しましょう。既存のデザインを崩さない、より控えめなアプローチに変更します。

```scss:sass/base/_front-page.scss
// 慣性スクロール用のスタイルを修正
.smooth-wrapper {
  overflow: visible; // fixedからvisibleに変更
  position: relative; // fixedからrelativeに変更
  width: 100%;
  min-height: 100%;
}

.smooth-content {
  overflow: visible;
  width: 100%;
}
```

```javascript:js/animetions.js
document.addEventListener('DOMContentLoaded', function() {
    // GSAP と ScrollTrigger を登録
    gsap.registerPlugin(ScrollTrigger);
    
    // ScrollSmootherが利用可能かチェック
    if (typeof ScrollSmoother !== 'undefined') {
        // より控えめな慣性スクロール設定
        const smoother = ScrollSmoother.create({
            wrapper: '.smooth-wrapper',
            content: '.smooth-content',
            smooth: 1,               // 慣性の強さを弱めに
            effects: false,          // デフォルトの効果を無効化
            normalizeScroll: false,  // 標準スクロールを維持
            ignoreMobileResize: true,
            smoothTouch: 0,          // タッチデバイスでは無効化
        });
        
        // メディアクエリでモバイルでは無効化
        const mediaQuery = window.matchMedia('(max-width: 768px)');
        if (mediaQuery.matches) {
            smoother.kill(); // モバイルでは無効化
        }
        
        // リサイズ時に再評価
        window.addEventListener('resize', () => {
            if (mediaQuery.matches) {
                smoother.kill();
            } else {
                smoother.restart();
            }
        });
    }
    
    // 既存のコードをそのまま維持...
    // .front-page__gallery をピン留め
    ScrollTrigger.create({
        trigger: ".front-page__achievements",
        start: "top top",
        end: "bottom top",
        pin: true,
        pinSpacing: false,
    });
    
    // 残りの既存コード...
```

```php:front-page.php
<?php get_header(); ?>

<div class="smooth-wrapper">
    <div class="smooth-content">
        <main class="front-page">
            <!-- 以下変更なし -->
        </main>
    </div>
</div>

<?php get_footer(); ?>
```

これらの変更により:
1. 固定位置から相対位置に変更してレイアウトフローを保持
2. 慣性効果を弱めてより自然なスクロール感に調整
3. モバイルでは無効化して互換性問題を防止
4. 他のアニメーションとの干渉を最小限に

デザインを崩さずに慣性スクロールを適用できるはずです。もし他にも特定の部分で問題が発生していれば、それを教えていただければさらに調整できます。

---

_**User**_

いまいち@animetions.js @_front-page.scss @front-page.php 
もっとfront-page__galleryのパララックススクロールアニメーションをいい感じにして

---

_**Assistant**_



---

ギャラリーセクションのパララックスアニメーションを強化します。画像の動きをよりスムーズにし、各要素に異なる速度とタイミングを持たせます：

```javascript:js/animetions.js
// ギャラリーセクションのパララックスアニメーション強化
document.addEventListener('DOMContentLoaded', function() {
    // GSAP と ScrollTrigger を登録
    gsap.registerPlugin(ScrollTrigger);
    
    // ギャラリーのパララックス効果を強化
    function initGalleryParallax() {
        // 左側ギャラリー要素のアニメーション
        const leftItems = document.querySelectorAll('.gallery__side--left .gallery__item');
        leftItems.forEach((item, index) => {
            const speed = 0.5 + (index * 0.1); // 各アイテムに異なる速度を設定
            gsap.fromTo(item, 
                { y: 0, opacity: 0.4, scale: 0.95 },
                {
                    y: `-${15 + (index * 5)}%`, // 異なる移動距離
                    opacity: 1,
                    scale: 1,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".front-page__gallery",
                        start: "top bottom",
                        end: "bottom top",
                        scrub: speed, // スクロールとの連動度合い
                        markers: false
                    }
                }
            );
        });
        
        // 右側ギャラリー要素のアニメーション
        const rightItems = document.querySelectorAll('.gallery__side--right .gallery__item');
        rightItems.forEach((item, index) => {
            const speed = 0.7 + (index * 0.15); // 右側は少し異なる速度
            gsap.fromTo(item, 
                { y: 0, opacity: 0.4, scale: 0.95 },
                {
                    y: `-${20 + (index * 7)}%`,
                    opacity: 1, 
                    scale: 1,
                    ease: "none",
                    scrollTrigger: {
                        trigger: ".front-page__gallery",
                        start: "top bottom",
                        end: "bottom top",
                        scrub: speed,
                        markers: false
                    }
                }
            );
        });
        
        // ギャラリーコンテナの背景アニメーション
        gsap.fromTo(".front-page__gallery-container", 
            { backgroundPosition: "50% 0%" },
            {
                backgroundPosition: "50% 100%",
                ease: "none",
                scrollTrigger: {
                    trigger: ".front-page__gallery",
                    start: "top bottom",
                    end: "bottom top",
                    scrub: 1,
                    markers: false
                }
            }
        );
        
        // 回転要素を追加
        gsap.to(".gallery__item--3", {
            rotateZ: 5,
            ease: "sine.inOut",
            scrollTrigger: {
                trigger: ".front-page__gallery",
                start: "top center",
                end: "bottom top",
                scrub: 2
            }
        });
        
        gsap.to(".gallery__item--7", {
            rotateZ: -5,
            ease: "sine.inOut",
            scrollTrigger: {
                trigger: ".front-page__gallery",
                start: "top center",
                end: "bottom top",
                scrub: 2.5
            }
        });
        
        // 3Dパースペクティブ効果
        document.querySelector('.front-page__gallery').style.perspective = '1000px';
        
        gsap.to(".gallery__side--left", {
            rotateY: 10,
            transformOrigin: "left center",
            scrollTrigger: {
                trigger: ".front-page__gallery",
                start: "top center",
                end: "center top",
                scrub: 3
            }
        });
        
        gsap.to(".gallery__side--right", {
            rotateY: -10,
            transformOrigin: "right center",
            scrollTrigger: {
                trigger: ".front-page__gallery",
                start: "top center",
                end: "center top",
                scrub: 3
            }
        });
    }

    // 既存のコード
    if (typeof ScrollSmoother !== 'undefined') {
        // 慣性スクロール設定（既存のコード）
    }
    
    // ギャラリーのパララックス初期化を呼び出し
    initGalleryParallax();
    
    // 残りの既存アニメーションコード...
});
```

```scss:sass/base/_front-page.scss
// ギャラリーセクション強化用のスタイル
.front-page__gallery {
  position: relative;
  z-index: 1;
  background-color: #fff;
  width: 100vw;
  height: 150vh;
  overflow: hidden;
  transform-style: preserve-3d; // 3D効果のため追加
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle at center, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 70%);
    opacity: 0.7;
    pointer-events: none;
    z-index: 1;
  }
}

.front-page__gallery-container {
  position: relative;
  z-index: 1;
  background-image: url('../images/front-page/garallry-back.webp');
  background-size: 150% auto; // 拡大して背景の動きを強調
  background-position: center;
  background-repeat: no-repeat;
  height: inherit;
  width: 20%;
  margin: 0 auto;
  will-change: background-position; // パフォーマンス最適化
}

// ギャラリーアイテムの基本スタイル強化
.gallery__item {
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  transition: transform 0.3s ease;
  will-change: transform, opacity; // パフォーマンス最適化
  
  &:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 12px 25px rgba(0,0,0,0.2);
  }
  
  img {
    transition: transform 0.6s ease;
    
    &:hover {
      transform: scale(1.05);
    }
  }
}

// サイド全体の動きを調整
.gallery__side {
  position: absolute;
  top: 50%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-around;
  z-index: 3;
  transform-style: preserve-3d; // 3D効果用
  
  &--left {
    left: 9%;
  }
  
  &--right {
    right: -2%;
  }
  
  @include mq-md {
    display: none;
  }
}
```

この実装により:
1. 各ギャラリー画像が異なるスピードと距離でスクロールに反応
2. 画像に微妙な回転効果を追加し、立体感を強調
3. 3Dパースペクティブ効果を追加して奥行き感を演出
4. ホバー時のインタラクションを強化
5. 背景画像がスクロールに合わせて動く効果を追加

これらの効果が組み合わさることで、より洗練されたパララックスアニメーションになります。front-page.phpファイルの変更は必要ありません。

---

_**User**_

もっと洗練して今一度目のスクロールは正常に動いているけど、戻ったりすると挙動がおかしくなる
@animetions.js 

---

_**Assistant**_

```javascript:js/animetions.js
// ... 既存コード（GSAP/ScrollTrigger の登録〜.front-page__achievements の pin など） ...

// ----------------------------
// 旧 initGalleryParallax() を置き換え
// ----------------------------

// ▼ 改良版ギャラリーパララックス
function createGalleryParallax() {
  /* すでに作成済みの “gallery-parallax” 系トリガーを全て破棄して
     重複アニメーション・逆スクロール時の不整合を防止 */
  ScrollTrigger.getAll().forEach(tg => {
    if (tg.vars.id && tg.vars.id.startsWith('gallery-parallax')) tg.kill();
  });

  // 左側のアイテム -----------------
  gsap.utils.toArray('.gallery__side--left .gallery__item').forEach((el, i) => {
    gsap.fromTo(
      el,
      { y: 0 },
      {
        /* 各アイテムごとに距離を変え、scrub:true で往復とも滑らかに */
        y: () => -(window.innerHeight * 0.15 + i * window.innerHeight * 0.05),
        ease: 'none',
        id: `gallery-parallax-left-${i}`,
        scrollTrigger: {
          id: `gallery-parallax-left-${i}`,
          trigger: '.front-page__gallery',
          start: 'top bottom',
          end: 'bottom top',
          scrub: true,
          invalidateOnRefresh: true, // リサイズ／history back 対応
        },
      },
    );
  });

  // 右側のアイテム -----------------
  gsap.utils.toArray('.gallery__side--right .gallery__item').forEach((el, i) => {
    gsap.fromTo(
      el,
      { y: 0 },
      {
        y: () => -(window.innerHeight * 0.2 + i * window.innerHeight * 0.07),
        ease: 'none',
        id: `gallery-parallax-right-${i}`,
        scrollTrigger: {
          id: `gallery-parallax-right-${i}`,
          trigger: '.front-page__gallery',
          start: 'top bottom',
          end: 'bottom top',
          scrub: true,
          invalidateOnRefresh: true,
        },
      },
    );
  });

  // 背景（中央コンテナ） -------------
  gsap.fromTo(
    '.front-page__gallery-container',
    { backgroundPosition: '50% 0%' },
    {
      backgroundPosition: '50% 100%',
      ease: 'none',
      id: 'gallery-parallax-bg',
      scrollTrigger: {
        id: 'gallery-parallax-bg',
        trigger: '.front-page__gallery',
        start: 'top bottom',
        end: 'bottom top',
        scrub: true,
        invalidateOnRefresh: true,
      },
    },
  );
}

// 初回実行
createGalleryParallax();

/* ScrollTrigger がリフレッシュされるたび（戻る/進む・resize・lazyload 等）
   にも再生成して常に正しい座標を使用 */
ScrollTrigger.addEventListener('refreshInit', createGalleryParallax);
window.addEventListener('resize', () => ScrollTrigger.refresh());

// ... 既存コード（ヒーロータイトルアニメーション等） ...
```

### 改善ポイント
1. `invalidateOnRefresh:true` と `refreshInit` 再初期化で  
   ・ブラウザの戻る/進む  
   ・リサイズ  
   ・ScrollTrigger.refresh() 呼び出し  
   すべてで正しい位置計算を再取得。
2. 生成済み `gallery-parallax*` ID のトリガーを kill して重複排除。
3. `scrub:true` 専用アニメで逆スクロールでも滑らかに往復。
4. Y 移動距離を `window.innerHeight` から計算し、リサイズに追従。

---

_**User**_

ギャラリーセクション今までのアニメーション一回削除して新しくアニメーションつけて

創造的で目を惹きつけるようなアニメーション
イメージはスクロールすると両サイドの画像が徐々になななめ上に開いていってその奥から開くのに合わせて
front-page__gallery-containerが少しずつ見えてくる感じ

---

_**Assistant**_



---

```javascript:js/animetions.js
document.addEventListener('DOMContentLoaded', function() {
    // GSAP と ScrollTrigger を登録
    gsap.registerPlugin(ScrollTrigger);
    
    // ScrollSmootherが利用可能かチェック（ここは既存コードを維持）
    if (typeof ScrollSmoother !== 'undefined') {
        // 慣性スクロール設定（既存コード）
        const smoother = ScrollSmoother.create({
            wrapper: '.smooth-wrapper',
            content: '.smooth-content',
            smooth: 1,
            effects: false,
            normalizeScroll: false,
            ignoreMobileResize: true,
            smoothTouch: 0,
        });
        
        // メディアクエリでモバイル対応（既存コード）
        const mediaQuery = window.matchMedia('(max-width: 768px)');
        if (mediaQuery.matches) {
            smoother.kill();
        }
        
        window.addEventListener('resize', () => {
            if (mediaQuery.matches) {
                smoother.kill();
            } else {
                smoother.restart();
            }
        });
    }
    
    // 実績セクションのピン留め（既存コード）
    ScrollTrigger.create({
        trigger: ".front-page__achievements",
        start: "top top",
        end: "bottom top",
        pin: true,
        pinSpacing: false,
    });
    
    // ヒーロータイトルのアニメーション（既存コード）
    const animationClasses = [
        'animated-fade-in', 'animated-slide-up', 'animated-scale-in',
        'animated-wave-sway', 'animated-water-shimmer', 'animated-mist-reveal',
        'animated-ocean-rise', 'animated-tide-flow', 'animated-typewriter'
    ];
    
    const heroTitle = document.querySelector('.front-page__hero-title');
    if (heroTitle) {
        // 既存のヒーロータイトルアニメーションコード
        // ...
    }

    // ギャラリーセクションの新しいアニメーション
    function setupGalleryAnimation() {
        // 以前のアニメーションを全て削除
        ScrollTrigger.getAll().forEach(trigger => {
            if (trigger.vars && trigger.vars.id && 
                (trigger.vars.id.includes('gallery') || 
                 String(trigger.trigger).includes('gallery'))) {
                trigger.kill();
            }
        });
        
        // ギャラリーの初期状態を設定
        const gallery = document.querySelector('.front-page__gallery');
        if (!gallery) return;
        
        // ギャラリーコンテナを初期状態では小さく透明に
        gsap.set('.front-page__gallery-container', {
            scale: 0.8,
            opacity: 0,
            filter: 'blur(10px)',
        });
        
        // 左右の画像を初期状態では中央寄りに配置
        gsap.set('.gallery__side--left', {
            x: '40%',
            y: '0%',
            opacity: 0.8,
            transformOrigin: 'center center',
        });
        
        gsap.set('.gallery__side--right', {
            x: '-40%',
            y: '0%',
            opacity: 0.8,
            transformOrigin: 'center center',
        });
        
        // スクロールに合わせたアニメーションタイムライン
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.front-page__gallery',
                start: 'top bottom',
                end: 'bottom top',
                scrub: 1,
                invalidateOnRefresh: true,
                id: 'gallery-reveal-animation',
            }
        });
        
        // 左右の画像が斜め上に開いていくアニメーション
        tl.to('.gallery__side--left', {
            x: '-20%',
            y: '-25%',
            rotate: -5,
            opacity: 1,
            ease: 'power1.inOut',
        }, 0);
        
        tl.to('.gallery__side--right', {
            x: '20%',
            y: '-25%',
            rotate: 5,
            opacity: 1,
            ease: 'power1.inOut',
        }, 0);
        
        // 同時に中央コンテナが現れる
        tl.to('.front-page__gallery-container', {
            scale: 1,
            opacity: 0.9,
            filter: 'blur(0px)',
            ease: 'power2.out',
        }, 0.1);
        
        // 各画像に個別のアニメーションを追加
        const leftItems = ['.gallery__item--1', '.gallery__item--2', '.gallery__item--3', '.gallery__item--4'];
        const rightItems = ['.gallery__item--5', '.gallery__item--6', '.gallery__item--7', '.gallery__item--8'];
        
        // 左側のアイテムにずらして個別アニメーション
        leftItems.forEach((item, i) => {
            gsap.set(item, { 
                y: `${20 + i * 10}%`, 
                opacity: 0.5,
                rotateZ: -5,
                scale: 0.9
            });
            
            tl.to(item, {
                y: `${i * 5}%`,
                opacity: 1,
                rotateZ: gsap.utils.random(-2, 2),
                scale: 1,
                delay: i * 0.05,
                ease: 'power1.out'
            }, 0.2);
        });
        
        // 右側のアイテムにずらして個別アニメーション
        rightItems.forEach((item, i) => {
            gsap.set(item, { 
                y: `${20 + i * 10}%`, 
                opacity: 0.5,
                rotateZ: 5,
                scale: 0.9
            });
            
            tl.to(item, {
                y: `${i * 5}%`,
                opacity: 1,
                rotateZ: gsap.utils.random(-2, 2),
                scale: 1,
                delay: i * 0.05,
                ease: 'power1.out'
            }, 0.2);
        });
        
        // 3D効果を強化
        gallery.style.perspective = '1200px';
        
        // 画像の影を強調するアニメーション
        tl.to('.gallery__item', {
            boxShadow: '0 15px 30px rgba(0,0,0,0.2)',
            duration: 1,
        }, 0.3);
        
        // ギャラリー全体のバックライト効果
        const overlay = document.createElement('div');
        overlay.className = 'gallery-lighting-overlay';
        gallery.appendChild(overlay);
        
        gsap.set('.gallery-lighting-overlay', {
            position: 'absolute',
            top: 0,
            left: 0,
            width: '100%',
            height: '100%',
            background: 'radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%)',
            opacity: 0,
            pointerEvents: 'none',
            zIndex: 3
        });
        
        tl.to('.gallery-lighting-overlay', {
            opacity: 0.8,
            ease: 'power2.inOut'
        }, 0.4);
    }
    
    // 初回実行
    setupGalleryAnimation();
    
    // リサイズと戻る操作に対応
    ScrollTrigger.addEventListener('refreshInit', setupGalleryAnimation);
    window.addEventListener('resize', () => ScrollTrigger.refresh());
    
    // 既存の他のアニメーションコード...
});
```

このコードでは：

1. 既存のギャラリーアニメーションをすべて削除
2. 新しい「ギャラリー開き」アニメーションを実装
   - 初期状態：両サイドの画像パネルが中央に寄っている
   - スクロール時：斜め上に開きながら奥から中央コンテナが現れる
   - 各画像にもずらして個別の動きを追加
3. 3D効果とライティング効果を追加して立体感を強調
4. リサイズ対応と戻るボタン対応を実装

上記の実装で、スクロール時に両サイドが斜め上に開いていき、その背後からコンテナが現れるという要望の効果を実現できます。

---

_**User**_

ちょっとイメージ違うね
@_front-page.scss 
イメージは扉、扉が開いたら中からfront-page__gallery-containerが出てくる感じ@animetions.js 

---

_**Assistant**_



---

両方のファイルを扉のようなアニメーションに変更します:

```scss:sass/base/_front-page.scss
// ギャラリーセクション - 扉のようなデザインに変更
.front-page__gallery {
  position: relative;
  z-index: 1;
  background-color: #000; // 暗い背景にして扉の効果を強調
  width: 100vw;
  height: 150vh;
  overflow: hidden;
  transform-style: preserve-3d; // 3D効果
  perspective: 1500px;
}

// コンテナを扉が開いたら見えるように
.front-page__gallery-container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  z-index: 1;
  background-image: url('../images/front-page/garallry-back.webp');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  height: 80%;
  width: 80%;
  max-width: 1200px;
  border-radius: 8px;
  box-shadow: 0 0 50px rgba(255,255,255,0.2);
  will-change: transform, opacity;
}

// サイドパネルを扉のようにデザイン
.gallery__side {
  position: absolute;
  top: 0;
  height: 100%;
  width: 50%;
  background-color: #1a1a1a;
  z-index: 10;
  transform-style: preserve-3d;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  will-change: transform;
  
  &--left {
    left: 0;
    transform-origin: left center;
    border-right: 1px solid rgba(255,255,255,0.1);
  }
  
  &--right {
    right: 0;
    transform-origin: right center;
    border-left: 1px solid rgba(255,255,255,0.1);
  }
  
  @include mq-md {
    display: none;
  }
}

// 扉のハンドルのようなデザイン要素
.gallery__side::after {
  content: '';
  position: absolute;
  top: 50%;
  width: 20px;
  height: 80px;
  background: rgba(255,255,255,0.1);
  border-radius: 10px;
  transform: translateY(-50%);
}

.gallery__side--left::after {
  right: 20px;
}

.gallery__side--right::after {
  left: 20px;
}

// 画像グリッドの整理
.gallery__item-img-wrapper {
  display: flex;
  padding: 40px;
  gap: 15px;
  height: 100%;
  flex-wrap: wrap;
  align-content: center;
  justify-content: center;
}

// 左側のドアの内側のレイアウト調整
.gallery__item-img-wrapper--left {
  justify-content: flex-end;
  padding-right: 60px;
}

// 各画像アイテムに立体感のあるデザイン
.gallery__item {
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  transform: scale(0.95);
  transition: transform 0.4s ease, box-shadow 0.4s ease;
  background-color: #fff;
  border: 3px solid #fff;
  
  &:hover {
    transform: scale(1.02) translateY(-5px);
    box-shadow: 0 15px 30px rgba(0,0,0,0.4);
    z-index: 5;
  }
  
  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s ease;
  }
}
```

```javascript:js/animetions.js
// ギャラリーセクションの扉アニメーション
function setupDoorAnimation() {
    // 以前のアニメーションを全て削除
    ScrollTrigger.getAll().forEach(trigger => {
        if (trigger.vars && trigger.vars.id && 
            (trigger.vars.id.includes('gallery') || 
             String(trigger.trigger).includes('gallery'))) {
            trigger.kill();
        }
    });
    
    // ギャラリーの初期状態を設定
    const gallery = document.querySelector('.front-page__gallery');
    if (!gallery) return;
    
    // 3D効果を強化
    gallery.style.perspective = '1500px';
    
    // コンテナを最初は隠す
    gsap.set('.front-page__gallery-container', {
        opacity: 0,
        scale: 0.8,
        z: -100,
    });
    
    // 左ドアは最初閉じている（回転なし）
    gsap.set('.gallery__side--left', {
        rotateY: 0,
    });
    
    // 右ドアも最初閉じている（回転なし）
    gsap.set('.gallery__side--right', {
        rotateY: 0,
    });
    
    // 画像を配置
    const leftItems = gsap.utils.toArray('.gallery__side--left .gallery__item');
    const rightItems = gsap.utils.toArray('.gallery__side--right .gallery__item');
    
    // 左側の画像を整理
    leftItems.forEach((item, i) => {
        gsap.set(item, {
            opacity: 0.8,
            y: gsap.utils.random(-20, 20),
            rotateZ: gsap.utils.random(-5, 5),
            scale: gsap.utils.random(0.85, 0.95)
        });
    });
    
    // 右側の画像を整理
    rightItems.forEach((item, i) => {
        gsap.set(item, {
            opacity: 0.8,
            y: gsap.utils.random(-20, 20),
            rotateZ: gsap.utils.random(-5, 5),
            scale: gsap.utils.random(0.85, 0.95)
        });
    });
    
    // メインのアニメーションタイムライン
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: '.front-page__gallery',
            start: 'top 70%', // 少し早めに始める
            end: 'center 30%',
            scrub: 1.5,       // よりスムーズな動き
            invalidateOnRefresh: true,
            id: 'gallery-door-animation',
        }
    });
    
    // 扉が開くアニメーション
    tl.to('.gallery__side--left', {
        rotateY: 105,         // 左扉が左に開く（内側に）
        ease: 'power2.inOut',
        duration: 3
    }, 0);
    
    tl.to('.gallery__side--right', {
        rotateY: -105,        // 右扉が右に開く（内側に）
        ease: 'power2.inOut', 
        duration: 3
    }, 0);
    
    // 扉が開いた後にコンテナが現れる
    tl.to('.front-page__gallery-container', {
        opacity: 1,
        scale: 1,
        z: 0,
        duration: 2,
        ease: 'power2.out'
    }, 1.5); // 扉が半分開いてから
    
    // 光の効果
    const light = document.createElement('div');
    light.className = 'gallery-door-light';
    gallery.appendChild(light);
    
    gsap.set('.gallery-door-light', {
        position: 'absolute',
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        background: 'radial-gradient(circle at center, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 70%)',
        opacity: 0,
        pointerEvents: 'none',
        zIndex: 2
    });
    
    // 光が漏れるように
    tl.to('.gallery-door-light', {
        opacity: 0.8,
        duration: 2,
        ease: 'power2.inOut'
    }, 1.2);
    
    // 画像が明るく鮮明になる
    tl.to(['.gallery__side--left .gallery__item', '.gallery__side--right .gallery__item'], {
        opacity: 1,
        y: 0,
        rotateZ: 0,
        scale: 1,
        stagger: 0.05,
        duration: 1.5,
        ease: 'back.out(1.2)'
    }, 0.8);
    
    // リサイズと戻る対応
    window.addEventListener('resize', () => {
        ScrollTrigger.refresh();
    });
}

// 初回実行
setupDoorAnimation();

// リサイズと戻る操作に対応
ScrollTrigger.addEventListener('refreshInit', setupDoorAnimation);
```

この実装で扉のようなアニメーションを実現します：

1. 左右のパネルが閉じた扉として表示され、スクロールすると内側に開きます
2. 扉が開くと中からコンテナが光と共に現れます
3. 扉の内側には写真がディスプレイされたように並んでいます
4. 3D効果でリアルな扉の開閉感を出しています

CSSでは扉らしいデザインに変更し、JavaScriptでは扉の開閉アニメーションを実装しています。

---

_**User**_

いい感じ！
扉の部分を両サイドの画像がもっと見える時間が長い方がいいので
扉が開くタイミンびはもっと上にスクロールした後
背景は白で



---

_**Assistant**_



---

```scss:sass/base/_front-page.scss
// ギャラリーセクション - 扉のようなデザインに変更
.front-page__gallery {
  position: relative;
  z-index: 1;
  background-color: #fff; // 黒から白に変更
  width: 100vw;
  height: 150vh;
  overflow: hidden;
  transform-style: preserve-3d; // 3D効果
  perspective: 1500px;
}

// コンテナを扉が開いたら見えるように
.front-page__gallery-container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  z-index: 1;
  background-image: url('../images/front-page/garallry-back.webp');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  height: 80%;
  width: 80%;
  max-width: 1200px;
  border-radius: 8px;
  box-shadow: 0 0 50px rgba(0,0,0,0.2); // 影の色を調整
  will-change: transform, opacity;
}

// サイドパネルを扉のようにデザイン
.gallery__side {
  position: absolute;
  top: 0;
  height: 100%;
  width: 50%;
  background-color: #f5f5f5; // 背景を明るくする
  z-index: 10;
  transform-style: preserve-3d;
  box-shadow: 0 0 20px rgba(0,0,0,0.2); // 影を薄く
  will-change: transform;
  
  &--left {
    left: 0;
    transform-origin: left center;
    border-right: 1px solid rgba(0,0,0,0.1); // 境界線の色を変更
  }
  
  &--right {
    right: 0;
    transform-origin: right center;
    border-left: 1px solid rgba(0,0,0,0.1); // 境界線の色を変更
  }
  
  @include mq-md {
    display: none;
  }
}

// 扉のハンドルのようなデザイン要素
.gallery__side::after {
  content: '';
  position: absolute;
  top: 50%;
  width: 20px;
  height: 80px;
  background: rgba(0,0,0,0.1); // 暗い背景から明るい背景に合わせて調整
  border-radius: 10px;
  transform: translateY(-50%);
}

// ... 既存コード ...
```

```javascript:js/animetions.js
// ギャラリーセクションの扉アニメーション
function setupDoorAnimation() {
    // 以前のアニメーションを全て削除
    ScrollTrigger.getAll().forEach(trigger => {
        if (trigger.vars && trigger.vars.id && 
            (trigger.vars.id.includes('gallery') || 
             String(trigger.trigger).includes('gallery'))) {
            trigger.kill();
        }
    });
    
    // ギャラリーの初期状態を設定
    const gallery = document.querySelector('.front-page__gallery');
    if (!gallery) return;
    
    // 3D効果を強化
    gallery.style.perspective = '1500px';
    
    // コンテナを最初は隠す
    gsap.set('.front-page__gallery-container', {
        opacity: 0,
        scale: 0.8,
        z: -100,
    });
    
    // 左ドアは最初閉じている（回転なし）
    gsap.set('.gallery__side--left', {
        rotateY: 0,
    });
    
    // 右ドアも最初閉じている（回転なし）
    gsap.set('.gallery__side--right', {
        rotateY: 0,
    });
    
    // 画像を配置
    const leftItems = gsap.utils.toArray('.gallery__side--left .gallery__item');
    const rightItems = gsap.utils.toArray('.gallery__side--right .gallery__item');
    
    // 左側の画像を整理
    leftItems.forEach((item, i) => {
        gsap.set(item, {
            opacity: 1, // 最初から完全に表示
            y: gsap.utils.random(-10, 10), // より小さな初期オフセット
            rotateZ: gsap.utils.random(-3, 3), // より控えめな回転
            scale: gsap.utils.random(0.92, 1)
        });
    });
    
    // 右側の画像を整理
    rightItems.forEach((item, i) => {
        gsap.set(item, {
            opacity: 1, // 最初から完全に表示
            y: gsap.utils.random(-10, 10), // より小さな初期オフセット
            rotateZ: gsap.utils.random(-3, 3), // より控えめな回転
            scale: gsap.utils.random(0.92, 1)
        });
    });
    
    // メインのアニメーションタイムライン
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: '.front-page__gallery',
            start: 'top 20%', // より上にスクロールした後に開始（遅く開始）
            end: 'center 10%', // よりスクロールが進んでから終了
            scrub: 1.8, // よりゆっくりなスクラブ
            invalidateOnRefresh: true,
            id: 'gallery-door-animation',
        }
    });
    
    // 扉が開くアニメーション（ゆっくりと）
    tl.to('.gallery__side--left', {
        rotateY: 105, // 左扉が左に開く（内側に）
        ease: 'power1.inOut', // よりゆっくりなイージング
        duration: 4 // より長いデュレーション
    }, 2); // 開始時間を遅らせる（より長く画像を見せる）
    
    tl.to('.gallery__side--right', {
        rotateY: -105, // 右扉が右に開く（内側に）
        ease: 'power1.inOut', // よりゆっくりなイージング
        duration: 4 // より長いデュレーション
    }, 2); // 開始時間を遅らせる（より長く画像を見せる）
    
    // 扉が開いた後にコンテナが現れる
    tl.to('.front-page__gallery-container', {
        opacity: 1,
        scale: 1,
        z: 0,
        duration: 2.5,
        ease: 'power2.out'
    }, 3.5); // 扉が半分以上開いてから
    
    // 光の効果
    const light = document.createElement('div');
    light.className = 'gallery-door-light';
    gallery.appendChild(light);
    
    gsap.set('.gallery-door-light', {
        position: 'absolute',
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        background: 'radial-gradient(circle at center, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0) 70%)',
        opacity: 0,
        pointerEvents: 'none',
        zIndex: 2
    });
    
    // 光が漏れるように
    tl.to('.gallery-door-light', {
        opacity: 0.5, // より控えめな光
        duration: 2,
        ease: 'power2.inOut'
    }, 3); // 扉が開き始めた後
    
    // 画像が明るく鮮明になるアニメーション
    tl.to(['.gallery__side--left .gallery__item', '.gallery__side--right .gallery__item'], {
        y: 0,
        rotateZ: 0,
        scale: 1,
        stagger: 0.05,
        duration: 1.5,
        ease: 'back.out(1.2)'
    }, 0.5); // スクロール開始後すぐに画像を整える
    
    // リサイズと戻る対応
    window.addEventListener('resize', () => {
        ScrollTrigger.refresh();
    });
}
```

---

_**User**_

上の余白なしで扉はの高さとfront-page__gallery-containerの高さは同じくらい
開いたらpin留めして、スクロールで画面いっぱいまで拡大拡大が終わった画面から消えていく

---

_**Assistant**_



---

```scss:sass/base/_front-page.scss
// ギャラリーセクション - 扉のようなデザインに変更
.front-page__gallery {
  position: relative;
  z-index: 1;
  background-color: #fff;
  width: 100vw;
  height: 100vh; // 高さを画面高さに
  overflow: hidden;
  transform-style: preserve-3d;
  perspective: 1500px;
  margin-top: 0; // 上の余白なし
}

// コンテナを扉が開いたら見えるように
.front-page__gallery-container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  margin: auto;
  z-index: 1;
  background-image: url('../images/front-page/garallry-back.webp');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  height: 100%; // 高さを100%に変更
  width: 90%; // 幅を調整
  max-width: 1400px;
  border-radius: 8px;
  box-shadow: 0 0 50px rgba(0,0,0,0.2);
  will-change: transform, opacity;
}

// サイドパネルを扉のようにデザイン
.gallery__side {
  position: absolute;
  top: 0;
  height: 100%; // 高さ100%
  width: 50%;
  background-color: #f5f5f5;
  z-index: 10;
  transform-style: preserve-3d;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  will-change: transform;
  
  &--left {
    left: 0;
    transform-origin: left center;
    border-right: 1px solid rgba(0,0,0,0.1);
  }
  
  &--right {
    right: 0;
    transform-origin: right center;
    border-left: 1px solid rgba(0,0,0,0.1);
  }
  
  @include mq-md {
    display: none;
  }
}
```

```javascript:js/animetions.js
// ギャラリーセクションの扉アニメーション
function setupDoorAnimation() {
    // 以前のアニメーションを全て削除
    ScrollTrigger.getAll().forEach(trigger => {
        if (trigger.vars && trigger.vars.id && 
            (trigger.vars.id.includes('gallery') || 
             String(trigger.trigger).includes('gallery'))) {
            trigger.kill();
        }
    });
    
    // ギャラリーの初期状態を設定
    const gallery = document.querySelector('.front-page__gallery');
    if (!gallery) return;
    
    // ピン留め設定
    ScrollTrigger.create({
        trigger: ".front-page__gallery",
        start: "top top",
        end: "+=300%", // スクロール量を長めに設定
        pin: true,
        pinSpacing: true,
        id: "gallery-pin"
    });
    
    // 3D効果を強化
    gallery.style.perspective = '1500px';
    
    // コンテナを最初は隠す
    gsap.set('.front-page__gallery-container', {
        opacity: 0,
        scale: 0.8,
        z: -100,
    });
    
    // 左右ドアの初期設定
    gsap.set(['.gallery__side--left', '.gallery__side--right'], {
        rotateY: 0,
    });
    
    // 画像を配置
    const leftItems = gsap.utils.toArray('.gallery__side--left .gallery__item');
    const rightItems = gsap.utils.toArray('.gallery__side--right .gallery__item');
    
    // 画像の初期状態設定
    [...leftItems, ...rightItems].forEach((item) => {
        gsap.set(item, {
            opacity: 1,
            y: gsap.utils.random(-10, 10),
            rotateZ: gsap.utils.random(-3, 3),
            scale: gsap.utils.random(0.92, 1)
        });
    });
    
    // メインのアニメーションタイムライン
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: '.front-page__gallery',
            start: 'top top',
            end: '+=300%',
            scrub: 1.5,
            invalidateOnRefresh: true,
            id: 'gallery-door-animation',
        }
    });
    
    // 扉が開くアニメーション（スクロールの最初の25%で）
    tl.to('.gallery__side--left', {
        rotateY: 105,
        ease: 'power1.inOut',
        duration: 3
    }, 1);
    
    tl.to('.gallery__side--right', {
        rotateY: -105,
        ease: 'power1.inOut',
        duration: 3
    }, 1);
    
    // コンテナが現れて拡大するアニメーション
    tl.to('.front-page__gallery-container', {
        opacity: 1,
        scale: 1,
        z: 0,
        duration: 2,
        ease: 'power2.out'
    }, 2.5);
    
    // コンテナが画面いっぱいに拡大
    tl.to('.front-page__gallery-container', {
        scale: 1.5,
        duration: 4,
        ease: 'power1.inOut'
    }, 5);
    
    // 最後に全体をフェードアウト
    tl.to(['.front-page__gallery-container', '.gallery__side--left', '.gallery__side--right', '.gallery-door-light'], {
        opacity: 0,
        duration: 2,
        ease: 'power1.in'
    }, 8);
    
    // 光の効果
    const light = document.createElement('div');
    light.className = 'gallery-door-light';
    gallery.appendChild(light);
    
    gsap.set('.gallery-door-light', {
        position: 'absolute',
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        background: 'radial-gradient(circle at center, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0) 70%)',
        opacity: 0,
        pointerEvents: 'none',
        zIndex: 2
    });
    
    // 光の効果アニメーション
    tl.to('.gallery-door-light', {
        opacity: 0.5,
        duration: 2,
        ease: 'power2.inOut'
    }, 2);
    
    // 画像が整うアニメーション
    tl.to(['.gallery__side--left .gallery__item', '.gallery__side--right .gallery__item'], {
        y: 0,
        rotateZ: 0,
        scale: 1,
        stagger: 0.05,
        duration: 1.5,
        ease: 'back.out(1.2)'
    }, 0.5);
    
    // リサイズ対応
    window.addEventListener('resize', () => {
        ScrollTrigger.refresh();
    });
}
```

---

_**User**_

光のエフェクトいらない
最後もフェードアウトしなくていい

---

_**Assistant**_



---

```javascript:js/animetions.js
// ギャラリーセクションの扉アニメーション
function setupDoorAnimation() {
    // 以前のアニメーションを全て削除
    ScrollTrigger.getAll().forEach(trigger => {
        if (trigger.vars && trigger.vars.id && 
            (trigger.vars.id.includes('gallery') || 
             String(trigger.trigger).includes('gallery'))) {
            trigger.kill();
        }
    });
    
    // ギャラリーの初期状態を設定
    const gallery = document.querySelector('.front-page__gallery');
    if (!gallery) return;
    
    // ピン留め設定
    ScrollTrigger.create({
        trigger: ".front-page__gallery",
        start: "top top",
        end: "+=300%", // スクロール量を長めに設定
        pin: true,
        pinSpacing: true,
        id: "gallery-pin"
    });
    
    // 3D効果を強化
    gallery.style.perspective = '1500px';
    
    // コンテナを最初は隠す
    gsap.set('.front-page__gallery-container', {
        opacity: 0,
        scale: 0.8,
        z: -100,
    });
    
    // 左右ドアの初期設定
    gsap.set(['.gallery__side--left', '.gallery__side--right'], {
        rotateY: 0,
    });
    
    // 画像を配置
    const leftItems = gsap.utils.toArray('.gallery__side--left .gallery__item');
    const rightItems = gsap.utils.toArray('.gallery__side--right .gallery__item');
    
    // 画像の初期状態設定
    [...leftItems, ...rightItems].forEach((item) => {
        gsap.set(item, {
            opacity: 1,
            y: gsap.utils.random(-10, 10),
            rotateZ: gsap.utils.random(-3, 3),
            scale: gsap.utils.random(0.92, 1)
        });
    });
    
    // メインのアニメーションタイムライン
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: '.front-page__gallery',
            start: 'top top',
            end: '+=300%',
            scrub: 1.5,
            invalidateOnRefresh: true,
            id: 'gallery-door-animation',
        }
    });
    
    // 扉が開くアニメーション（スクロールの最初の25%で）
    tl.to('.gallery__side--left', {
        rotateY: 105,
        ease: 'power1.inOut',
        duration: 3
    }, 1);
    
    tl.to('.gallery__side--right', {
        rotateY: -105,
        ease: 'power1.inOut',
        duration: 3
    }, 1);
    
    // コンテナが現れて拡大するアニメーション
    tl.to('.front-page__gallery-container', {
        opacity: 1,
        scale: 1,
        z: 0,
        duration: 2,
        ease: 'power2.out'
    }, 2.5);
    
    // コンテナが画面いっぱいに拡大
    tl.to('.front-page__gallery-container', {
        scale: 1.5,
        duration: 4,
        ease: 'power1.inOut'
    }, 5);
    
    // 画像が整うアニメーション
    tl.to(['.gallery__side--left .gallery__item', '.gallery__side--right .gallery__item'], {
        y: 0,
        rotateZ: 0,
        scale: 1,
        stagger: 0.05,
        duration: 1.5,
        ease: 'back.out(1.2)'
    }, 0.5);
    
    // リサイズ対応
    window.addEventListener('resize', () => {
        ScrollTrigger.refresh();
    });
}
```

---

_**User**_

md3（920px）以下のサイズではfront-page__achievementsのpin留めはなしで

---

_**Assistant**_



---

```javascript:js/animetions.js
document.addEventListener('DOMContentLoaded', function() {
    // GSAP と ScrollTrigger を登録
    gsap.registerPlugin(ScrollTrigger);
    
    // ScrollSmootherが利用可能かチェック
    if (typeof ScrollSmoother !== 'undefined') {
        // より控えめな慣性スクロール設定
        const smoother = ScrollSmoother.create({
            wrapper: '.smooth-wrapper',
            content: '.smooth-content',
            smooth: 1,
            effects: false,
            normalizeScroll: false,
            ignoreMobileResize: true,
            smoothTouch: 0,
        });
        
        // メディアクエリでモバイルでは無効化
        const mediaQuery = window.matchMedia('(max-width: 768px)');
        if (mediaQuery.matches) {
            smoother.kill();
        }
        
        // リサイズ時に再評価
        window.addEventListener('resize', () => {
            if (mediaQuery.matches) {
                smoother.kill();
            } else {
                smoother.restart();
            }
        });
    }
    
    // 920px以上の場合のみachievementsセクションをピン留め
    const achievementsMediaQuery = window.matchMedia('(min-width: 921px)');
    
    if (achievementsMediaQuery.matches) {
        ScrollTrigger.create({
            trigger: ".front-page__achievements",
            start: "top top",
            end: "bottom top",
            pin: true,
            pinSpacing: false,
            id: "achievements-pin"
        });
    }
    
    // リサイズ時にachievementsセクションのピン留めを再評価
    achievementsMediaQuery.addEventListener('change', (e) => {
        // 既存のトリガーを削除
        ScrollTrigger.getAll().forEach(trigger => {
            if (trigger.vars && trigger.vars.id === "achievements-pin") {
                trigger.kill();
            }
        });
        
        // 920px以上の場合のみ再作成
        if (e.matches) {
            ScrollTrigger.create({
                trigger: ".front-page__achievements",
                start: "top top",
                end: "bottom top",
                pin: true,
                pinSpacing: false,
                id: "achievements-pin"
            });
        }
        
        // スクロールトリガーを更新
        ScrollTrigger.refresh();
    });
    
    // ギャラリーセクションの扉アニメーション
    function setupDoorAnimation() {
        // 以前のアニメーションを全て削除
        ScrollTrigger.getAll().forEach(trigger => {
            if (trigger.vars && trigger.vars.id && 
                (trigger.vars.id.includes('gallery') || 
                 String(trigger.trigger).includes('gallery'))) {
                trigger.kill();
            }
        });
        
        // ギャラリーの初期状態を設定
        const gallery = document.querySelector('.front-page__gallery');
        if (!gallery) return;
        
        // ピン留め設定 - md3以上でのみ適用
        if (window.matchMedia('(min-width: 921px)').matches) {
            ScrollTrigger.create({
                trigger: ".front-page__gallery",
                start: "top top",
                end: "+=300%",
                pin: true,
                pinSpacing: true,
                id: "gallery-pin"
            });
        }
        
        // 3D効果を強化
        gallery.style.perspective = '1500px';
        
        // コンテナを最初は隠す
        gsap.set('.front-page__gallery-container', {
            opacity: 0,
            scale: 0.8,
            z: -100,
        });
        
        // 左右ドアの初期設定
        gsap.set(['.gallery__side--left', '.gallery__side--right'], {
            rotateY: 0,
        });
        
        // 画像を配置
        const leftItems = gsap.utils.toArray('.gallery__side--left .gallery__item');
        const rightItems = gsap.utils.toArray('.gallery__side--right .gallery__item');
        
        // 画像の初期状態設定
        [...leftItems, ...rightItems].forEach((item) => {
            gsap.set(item, {
                opacity: 1,
                y: gsap.utils.random(-10, 10),
                rotateZ: gsap.utils.random(-3, 3),
                scale: gsap.utils.random(0.92, 1)
            });
        });
        
        // メインのアニメーションタイムライン
        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.front-page__gallery',
                start: 'top top',
                end: '+=300%',
                scrub: 1.5,
                invalidateOnRefresh: true,
                id: 'gallery-door-animation',
            }
        });
        
        // 扉が開くアニメーション
        tl.to('.gallery__side--left', {
            rotateY: 105,
            ease: 'power1.inOut',
            duration: 3
        }, 1);
        
        tl.to('.gallery__side--right', {
            rotateY: -105,
            ease: 'power1.inOut',
            duration: 3
        }, 1);
        
        // コンテナが現れて拡大するアニメーション
        tl.to('.front-page__gallery-container', {
            opacity: 1,
            scale: 1,
            z: 0,
            duration: 2,
            ease: 'power2.out'
        }, 2.5);
        
        // コンテナが画面いっぱいに拡大
        tl.to('.front-page__gallery-container', {
            scale: 1.5,
            duration: 4,
            ease: 'power1.inOut'
        }, 5);
        
        // 画像が整うアニメーション
        tl.to(['.gallery__side--left .gallery__item', '.gallery__side--right .gallery__item'], {
            y: 0,
            rotateZ: 0,
            scale: 1,
            stagger: 0.05,
            duration: 1.5,
            ease: 'back.out(1.2)'
        }, 0.5);
        
        // リサイズ対応
        window.addEventListener('resize', () => {
            ScrollTrigger.refresh();
        });
    }
    
    // 初回実行
    setupDoorAnimation();
    
    // リサイズと戻る操作に対応
    ScrollTrigger.addEventListener('refreshInit', setupDoorAnimation);
});
```

---

